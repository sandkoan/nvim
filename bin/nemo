#!/usr/bin/env bash


clean() {
    if command -v /usr/bin/nvim &> /dev/null
    then
        nvim -c source ~/.config/nvim/init.vim
        nvim -c PlugClean
        echo 'Unwanted plugins successfully removed'
    else
        echo 'Please install neovim'
        exit 1
    fi
}

install() {
    if command -v /usr/bin/nvim &> /dev/null
    then
        nvim -c source ~/.config/nvim/init.vim
        nvim -c PlugInstall
        echo 'New plugins successfully installed'
    else
        echo 'Please install neovim'
        exit 1
    fi
}


update() {
    if command -v /usr/bin/nvim &> /dev/null
    then
        nvim -c source ~/.config/nvim/init.vim
        nvim -c PlugUpdate
        echo 'Plugins successfully updated'
    else
        echo 'Please install neovim'
        exit 1
    fi
}

sync() {
    clean && install && update
}


upgrade() {
    if command -v /usr/bin/nvim &> /dev/null
    then
        nvim -c PlugUpgrade
        cd ~/.config/nvim && git pull || exit 1
        sync
        echo 'Nemo successfully upgraded with latest changes'
    else
        echo 'Please install neovim'
        exit 1
    fi
}

main() {
    while getopts "upgrade:sync" opt; do
        case ${opt} in
            upgrade ) upgrade
                ;;
            sync ) sync
                ;;
            \? ) echo "Usage: $0 [upgrade][sync]" && exit 1
                ;;
        esac
    done
}

main
